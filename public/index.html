<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实时二维码分享 - 课堂签到</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏠 课堂签到系统</h1>
            <p class="subtitle">实时二维码分享</p>
        </div>

        <div class="role-selection">
            <div class="role-card scanner-card">
                <div class="role-icon">🏠</div>
                <h2>我在教室</h2>
                <p>负责现场扫描二维码</p>
                <ul class="features">
                    <li>📷 自动启动摄像头</li>
                    <li>⚡ 实时扫描传输</li>
                    <li>🔍 智能变焦控制</li>
                </ul>
                <a href="scanner.html" class="btn btn-primary">开始扫码</a>
            </div>

            <div class="role-card viewer-card">
                <div class="role-icon">📱</div>
                <h2>我不在教室</h2>
                <p>远程查看实时二维码</p>
                <ul class="features">
                    <li>📺 实时同步显示</li>
                    <li>🔗 一键跳转链接</li>
                    <li>📱 支持多端观看</li>
                </ul>
                <a href="viewer.html" class="btn btn-secondary">查看二维码</a>
            </div>
        </div>

        <div class="info-section">
            <div class="status-info">
                <div class="status-item">
                    <span class="status-label">在线人数:</span>
                    <span class="status-value" id="scannerCount">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">系统状态:</span>
                    <span class="status-value" id="connectionStatus">连接中...</span>
                </div>
            </div>

            <div class="instructions">
                <h3>💡 使用说明</h3>
                <ol>
                    <li><strong>在教室</strong>：选择"我在教室"，自动启动摄像头扫描二维码</li>
                    <li><strong>不在教室</strong>：选择"我不在教室"，实时查看二维码内容</li>
                    <li>支持手动调节焦距和前后摄像头切换</li>
                    <li>扫描成功后可一键自动签到</li>
                </ol>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const scannerCountEl = document.getElementById('scannerCount');
        const connectionStatusEl = document.getElementById('connectionStatus');

        socket.on('connect', () => {
            connectionStatusEl.textContent = '已连接';
            connectionStatusEl.className = 'status-value connected';
        });

        socket.on('disconnect', () => {
            connectionStatusEl.textContent = '连接断开';
            connectionStatusEl.className = 'status-value disconnected';
        });

        socket.on('scanner-count', (count) => {
            scannerCountEl.textContent = count;
        });

        socket.on('connect_error', () => {
            connectionStatusEl.textContent = '连接失败';
            connectionStatusEl.className = 'status-value disconnected';
        });
    </script>
</body>
</html>